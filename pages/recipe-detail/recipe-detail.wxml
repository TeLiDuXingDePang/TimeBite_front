<!-- èœè°±è¯¦æƒ…é¡µ -->
<view class="recipe-detail-container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{isLoading}}">
    <view class="loading-spinner"></view>
    <view class="loading-text">åŠ è½½èœè°±è¯¦æƒ…ä¸­...</view>
  </view>
  
  <!-- é”™è¯¯çŠ¶æ€ -->
  <view class="error-container" wx:elif="{{loadError}}">
    <image class="error-icon" src="/images/icons/error.svg" mode="aspectFit"></image>
    <view class="error-text">åŠ è½½èœè°±è¯¦æƒ…å¤±è´¥</view>
    <view class="error-action" bindtap="goBack">è¿”å›</view>
  </view>
  
  <!-- èœè°±å†…å®¹ - ä»…åœ¨åŠ è½½æˆåŠŸä¸”æœ‰æ•°æ®æ—¶æ˜¾ç¤º -->
  <block wx:elif="{{recipe}}">
    <!-- å°é¢å›¾ -->
    <image class="recipe-cover" src="{{recipe.image}}" mode="aspectFill"></image>
    
    <!-- èœè°±æ ‡é¢˜å’ŒåŸºæœ¬ä¿¡æ¯ -->
    <view class="recipe-header">
      <view class="recipe-title">{{recipe.name}}</view>
      <view class="recipe-brief">{{recipe.brief || 'ä¸€é“ç¾å‘³åˆè¥å…»çš„å®¶å¸¸èœï¼Œç®€å•æ˜“åš'}}</view>
      
      <!-- èœè°±æ ‡ç­¾ -->
      <view class="recipe-tags" wx:if="{{recipe.tags && recipe.tags.length > 0}}">
        <view class="tag" wx:for="{{recipe.tags}}" wx:key="*this">{{item}}</view>
      </view>
    </view>
    
    <!-- åˆ†ç±»å¯¼èˆªæ  -->
    <view class="recipe-nav">
      <view class="nav-item {{currentTab === 'ingredients' ? 'active' : ''}}" bindtap="switchTab" data-tab="ingredients">
        <text>é£Ÿæ</text>
      </view>
      <view class="nav-item {{currentTab === 'tools' ? 'active' : ''}}" bindtap="switchTab" data-tab="tools">
        <text>å·¥å…·</text>
      </view>
      <view class="nav-item {{currentTab === 'preparation' ? 'active' : ''}}" bindtap="switchTab" data-tab="preparation">
        <text>é¢„å¤„ç†</text>
      </view>
      <view class="nav-item {{currentTab === 'steps' ? 'active' : ''}}" bindtap="switchTab" data-tab="steps">
        <text>æ­¥éª¤</text>
      </view>
      <view class="nav-item {{currentTab === 'tips' ? 'active' : ''}}" bindtap="switchTab" data-tab="tips">
        <text>å°è´´å£«</text>
      </view>
    </view>
    
    <!-- å†…å®¹åŒºåŸŸ -->
    <view class="recipe-content">
      <!-- é£Ÿææ¸…å• -->
      <view class="content-section" wx:if="{{currentTab === 'ingredients'}}">
        <view class="section-header">
          <view class="section-title">é£Ÿææ¸…å•</view>
          <view class="section-action" bindtap="copyIngredients">ä¸€é”®å¤åˆ¶</view>
        </view>
        
        <view class="ingredients-list">
          <view class="ingredient-group">
            <view class="group-title">ä¸»æ–™</view>
            <view class="ingredient-item" wx:for="{{recipe.mainIngredients}}" wx:key="name">
              <view class="ingredient-name">{{item.name}}</view>
              <view class="ingredient-amount">{{item.amount}}</view>
              <view class="ingredient-status {{item.status}}">{{item.statusText}}</view>
            </view>
          </view>
          
          <view class="ingredient-group" wx:if="{{recipe.accessories && recipe.accessories.length > 0}}">
            <view class="group-title">è¾…æ–™</view>
            <view class="ingredient-item" wx:for="{{recipe.accessories}}" wx:key="name">
              <view class="ingredient-name">{{item.name}}</view>
              <view class="ingredient-amount">{{item.amount}}</view>
              <view class="ingredient-status {{item.status}}">{{item.statusText}}</view>
            </view>
          </view>
          
          <view class="ingredient-group" wx:if="{{recipe.seasonings && recipe.seasonings.length > 0}}">
            <view class="group-title">è°ƒæ–™</view>
            <view class="ingredient-item" wx:for="{{recipe.seasonings}}" wx:key="name">
              <view class="ingredient-name">{{item.name}}</view>
              <view class="ingredient-amount">{{item.amount}}</view>
              <view class="ingredient-status {{item.status}}">{{item.statusText}}</view>
            </view>
          </view>
        </view>
        
        <view class="missing-ingredients" wx:if="{{missingIngredients && missingIngredients.length > 0}}">
          <view class="missing-title">ç¼ºå°‘çš„é£Ÿæ</view>
          <view class="missing-list">
            <view class="missing-item" wx:for="{{missingIngredients}}" wx:key="name">
              <text>{{item.name}} {{item.amount}}</text>
              <view class="add-to-cart" catchtap="addToCart" data-item="{{item}}">åŠ å…¥è´­ç‰©æ¸…å•</view>
            </view>
          </view>
        </view>
      </view>
      
      <!-- å·¥å…·å‡†å¤‡ -->
      <view class="content-section" wx:if="{{currentTab === 'tools'}}">
        <view class="section-header">
          <view class="section-title">å·¥å…·å‡†å¤‡</view>
        </view>
        
        <view class="tools-list" wx:if="{{recipe.tools && recipe.tools.length > 0}}">
          <view class="tool-item" wx:for="{{recipe.tools}}" wx:key="name">
            <view class="tool-emoji">{{item.emoji || 'ğŸ³'}}</view>
            <view class="tool-info">
              <view class="tool-name">{{item.name}}</view>
              <view class="tool-alternative" wx:if="{{item.alternative}}">æ›¿ä»£æ–¹æ¡ˆï¼š{{item.alternative}}</view>
            </view>
          </view>
        </view>
        
        <!-- æ— å·¥å…·æç¤º -->
        <view class="empty-tips" wx:else>
          <text>æ— éœ€ç‰¹æ®Šå·¥å…·ï¼Œä½¿ç”¨å¸¸è§å¨æˆ¿ç”¨å…·å³å¯</text>
        </view>
      </view>
      
      <!-- é¢„å¤„ç†æŒ‡å— -->
      <view class="content-section" wx:if="{{currentTab === 'preparation'}}">
        <view class="section-header">
          <view class="section-title">é¢„å¤„ç†æŒ‡å—</view>
        </view>
        
        <view class="preparation-list" wx:if="{{recipe.preparations && recipe.preparations.length > 0}}">
          <view class="preparation-item" wx:for="{{recipe.preparations}}" wx:key="index">
            <view class="preparation-step">{{index + 1}}</view>
            <view class="preparation-content">
              <view class="preparation-text">{{item.text}}</view>
              <image wx:if="{{item.image}}" class="preparation-image" src="{{item.image}}" mode="aspectFill"></image>
            </view>
          </view>
        </view>
        
        <!-- æ— é¢„å¤„ç†æ­¥éª¤æç¤º -->
        <view class="empty-tips" wx:else>
          <text>æ— éœ€ç‰¹æ®Šé¢„å¤„ç†ï¼Œå¯ç›´æ¥å¼€å§‹çƒ¹é¥ªæ­¥éª¤</text>
        </view>
      </view>
      
      <!-- çƒ¹é¥ªæ­¥éª¤ -->
      <view class="content-section" wx:if="{{currentTab === 'steps'}}">
        <view class="section-header">
          <view class="section-title">çƒ¹é¥ªæ­¥éª¤</view>
        </view>
        
        <view class="steps-list" wx:if="{{recipe.steps && recipe.steps.length > 0}}">
          <view class="step-item" wx:for="{{recipe.steps}}" wx:key="index">
            <view class="step-number">{{index + 1}}</view>
            <view class="step-content">
              <view class="step-text">{{item.text}}</view>
              <image wx:if="{{item.image}}" class="step-image" src="{{item.image}}" mode="aspectFill"></image>
            </view>
          </view>
        </view>
        
        <!-- æ— æ­¥éª¤æç¤º -->
        <view class="empty-tips" wx:else>
          <text>æš‚æ— è¯¦ç»†çƒ¹é¥ªæ­¥éª¤</text>
        </view>
      </view>
      
      <!-- çƒ¹é¥ªå°è´´å£« -->
      <view class="content-section" wx:if="{{currentTab === 'tips'}}">
        <view class="section-header">
          <view class="section-title">çƒ¹é¥ªå°è´´å£«</view>
        </view>
        
        <view class="tips-list" wx:if="{{recipe.tips && recipe.tips.length > 0}}">
          <view class="tip-item" wx:for="{{recipe.tips}}" wx:key="index">
            <image class="tip-icon" src="/assets/icons/tip.svg"></image>
            <view class="tip-text">{{item}}</view>
          </view>
        </view>
        
        <!-- æ— å°è´´å£«æç¤º -->
        <view class="empty-tips" wx:else>
          <text>æš‚æ— çƒ¹é¥ªå°è´´å£«</text>
        </view>
      </view>
    </view>
  </block>
</view> 